<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<meta name="theme-color" content="#0FA36B"/>

<title>
  Keeping Outlook Mailboxes Lean with n8n Our “Self-Cleaning Sent Items” Workflow | Zinus Tech Blog
</title>

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Keeping Outlook Mailboxes Lean with n8n Our “Self-Cleaning Sent Items” Workflow | Zinus Tech Blog</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Keeping Outlook Mailboxes Lean with n8n Our “Self-Cleaning Sent Items” Workflow" />
<meta name="author" content="Zinus Engineering" />
<meta property="og:locale" content="en" />
<meta name="description" content="A nightly n8n workflow that enforces Outlook mailbox quotas—deleting the oldest Sent Items until usage drops below 49%, preventing 100% lockups, and emailing a tidy report." />
<meta property="og:description" content="A nightly n8n workflow that enforces Outlook mailbox quotas—deleting the oldest Sent Items until usage drops below 49%, preventing 100% lockups, and emailing a tidy report." />
<link rel="canonical" href="http://localhost:4000/Zinus/posts/2025/09/05/keeping-outlook-mailboxes-lean-with-n8n/" />
<meta property="og:url" content="http://localhost:4000/Zinus/posts/2025/09/05/keeping-outlook-mailboxes-lean-with-n8n/" />
<meta property="og:site_name" content="Zinus Tech Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-09-05T00:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Keeping Outlook Mailboxes Lean with n8n Our “Self-Cleaning Sent Items” Workflow" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zinus Engineering"},"dateModified":"2025-09-05T00:00:00+09:00","datePublished":"2025-09-05T00:00:00+09:00","description":"A nightly n8n workflow that enforces Outlook mailbox quotas—deleting the oldest Sent Items until usage drops below 49%, preventing 100% lockups, and emailing a tidy report.","headline":"Keeping Outlook Mailboxes Lean with n8n Our “Self-Cleaning Sent Items” Workflow","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/Zinus/posts/2025/09/05/keeping-outlook-mailboxes-lean-with-n8n/"},"url":"http://localhost:4000/Zinus/posts/2025/09/05/keeping-outlook-mailboxes-lean-with-n8n/"}</script>
<!-- End Jekyll SEO tag -->


<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
<link rel="icon" href="/Zinus/assets/favicon.svg" type="image/svg+xml">

<link rel="stylesheet" href="/Zinus/assets/css/main.css">

<!-- Mermaid for diagrams in posts -->
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script>
  mermaid.initialize({
    startOnLoad: false,
    theme: 'default',
    securityLevel: 'loose',
    flowchart: { htmlLabels: false }
  });
</script>



  </head>
  <body class="site">
    <a class="skip-link" href="#content">Skip to content</a>
    <header class="site-header">
  <div class="container header__inner">
    <a class="brand" href="/Zinus/" aria-label="Zinus Tech Blog">
      <span class="brand__mark">Z</span>
      <span class="brand__name">Zinus Engineering</span>
    </a>
    <button class="nav-toggle" aria-expanded="false" aria-controls="site-nav">Menu</button>
    <nav id="site-nav" class="nav" aria-label="Primary navigation">
      <ul>
        
          <li><a href="http://localhost:4000/Zinus/">Home</a></li>
        
          <li><a href="http://localhost:4000/Zinus/posts/">Posts</a></li>
        
          <li><a href="http://localhost:4000/Zinus/about/">About</a></li>
        
      </ul>
    </nav>
  </div>
</header>
<script src="/Zinus/assets/js/site.js" defer></script>



    <main id="content" class="container">
      <article class="post">
  <header class="post__header">
    <h1 class="post__title">Keeping Outlook Mailboxes Lean with n8n Our “Self-Cleaning Sent Items” Workflow</h1>
    <div class="post__meta">
      <time datetime="2025-09-05T00:00:00+09:00">2025.09.05</time>
      
        · <span>Zinus Engineering</span>
      
    </div>
    
      <div class="post__authors">
        
          <a class="author" href="https://www.linkedin.com/in/junkukkim/" target="_blank" rel="noopener">
            
            <img class="author__avatar" src="/Zinus/assets/img/avatar-fallback.svg" alt="Junkuk Kim">
            <span class="author__meta">
              <span class="author__name">Junkuk Kim</span>
              <span class="author__role">DevOps Engineer, Zinus</span>
            </span>
          </a>
        
          <a class="author" href="https://www.linkedin.com/in/thebobhudgins/" target="_blank" rel="noopener">
            
            <img class="author__avatar" src="/Zinus/assets/img/avatar-fallback.svg" alt="Bobby Hudgins">
            <span class="author__meta">
              <span class="author__name">Bobby Hudgins</span>
              <span class="author__role">Software Engineer, Zinus</span>
            </span>
          </a>
        
      </div>
    
  </header>
  <div class="post__content">
    <blockquote>
  <p><strong>TL;DR:</strong> We built an n8n workflow that runs nightly, checks an Outlook mailbox’s storage, and—if usage is above 50%—permanently deletes the oldest messages from <strong>Sent Items</strong> until usage drops below 49%. It then emails a status report. Zero manual cleanup. Zero drama.</p>
</blockquote>

<hr />

<h2 id="why-we-built-this">Why we built this</h2>

<p>Mailbox quotas shouldn’t be a part-time job. We send a <em>lot</em> of automated emails, which means <strong>Sent Items</strong> can quietly balloon and tip an otherwise healthy mailbox over quota. We wanted a simple, deterministic guardrail that:</p>

<ul>
  <li>Enforces a <strong>hard ceiling</strong> on mailbox growth</li>
  <li>Requires <strong>no manual intervention</strong></li>
  <li>Leaves <strong>inbox and critical folders untouched</strong></li>
</ul>

<p>n8n was a perfect fit: visual, automatable, and great at orchestrating API calls with guardrails.</p>

<hr />

<h2 id="what-the-workflow-does-at-a-glance">What the workflow does (at a glance)</h2>

<ol>
  <li><strong>Runs nightly at midnight</strong> via <code class="language-plaintext highlighter-rouge">Schedule</code> trigger.</li>
  <li><strong>Checks mailbox usage</strong> through Microsoft Graph (read-only usage metrics).</li>
  <li><strong>If usage ≥ 50%</strong>, it:
    <ul>
      <li>Pulls <strong>oldest Sent Items</strong> in batches</li>
      <li>Permanently deletes those messages</li>
      <li>Re-checks usage and repeats until <strong>&lt; 49%</strong></li>
    </ul>
  </li>
  <li><strong>Sends a completion email</strong> with the final usage and how many messages were deleted.</li>
</ol>

<p>We intentionally use <strong>49%</strong> as the target to avoid bobbling around the threshold on the next run.</p>

<hr />

<h2 id="why-high-utilization-hurts">Why high utilization hurts</h2>

<ul>
  <li><strong>At 100% quota, mail flow stops.</strong> Hitting the maximum quota typically blocks <strong>sending</strong> and can block <strong>receiving</strong> as well—exactly the kind of outage we don’t want.</li>
  <li><strong>Client performance degrades.</strong> Large stores make desktop and mobile clients slower to start, search, and sync; local caches (OST/PST) swell and get more error-prone.</li>
  <li><strong>Search &amp; discovery slow down.</strong> Bigger mailboxes increase indexing time and make eDiscovery/compliance searches more expensive and sluggish.</li>
  <li><strong>Risk of missed automations.</strong> If quotas block mail, downstream processes that rely on email (alerts, approvals, receipts) can silently fail.</li>
  <li><strong>Operational overhead spikes.</strong> Backups and restores take longer; support escalations go up; users resort to manual triage instead of real work.</li>
</ul>

<hr />

<h2 id="node-by-node-tour">Node-by-node tour</h2>

<blockquote>
  <p>Naming below mirrors the canvas, with sensitive values abstracted.</p>
</blockquote>

<ul>
  <li><strong>Schedule Trigger</strong> – Fires at <code class="language-plaintext highlighter-rouge">00:00</code> every day.</li>
  <li><strong>Get All Folders</strong> → <strong>Get usage</strong> – Looks up folder IDs and retrieves usage stats (no secrets hard-coded).</li>
  <li><strong>Check if &gt; 50%</strong> – Branches on usage. If false, we short-circuit: log + notify.</li>
  <li><strong>Get Sent Items</strong> → <strong>Get Items List</strong> – Locates <strong>Sent Items</strong> and fetches a <strong>sorted oldest-first</strong> batch of IDs.</li>
  <li><strong>Batch Emails</strong> → <strong>Permanent Delete Emails</strong> – Deletes in controlled chunks; a brief <strong>Wait (0.1s)</strong> smooths bursts and avoids throttling.</li>
  <li><strong>Get updated usage</strong> – Re-reads usage to see if we’ve crossed below <strong>49%</strong>.</li>
  <li><strong>Return input / chooseBranch</strong> – Loop if still above threshold and no errors; otherwise summarize.</li>
  <li><strong>Previous usage &amp; Deleted Emails &amp; Errors…</strong> → <strong>Get deleted count</strong> → <strong>Send a message</strong> – Aggregates usage, deletion counts, and errors into a tidy status email.</li>
</ul>

<blockquote>
  <p>There’s also a small safety branch labeled <strong>“If Usage &gt; 40% &amp; No Errors”</strong> that keeps the loop resilient to transient reads and exits cleanly if anything looks off.</p>
</blockquote>

<hr />

<h2 id="the-control-loop-mermaid-flowchart">The control loop (Mermaid flowchart)</h2>

<pre><code class="language-mermaid">flowchart TD
  A[Schedule Trigger @ 00:00 daily] --&gt; B[Get mailbox usage]
  B --&gt;|usage &lt; 50%| C[Send status email: All good]:::done
  B --&gt;|usage ≥ 50%| D[Init total_deleted = 0]

  D --&gt; E[Fetch oldest Sent Items batch]
  E --&gt; F{Any IDs?}
  F --&gt;|No| G[Send status email: No items to delete]:::done
  F --&gt;|Yes| H[Hard delete batch]

  H --&gt; I[Wait 100 ms]
  I --&gt; J[Re-check mailbox usage]
  J --&gt; K{usage ≥ 49%?}
  K --&gt;|Yes| E
  K --&gt;|No| L[Send status email: Cleanup complete]:::done

  classDef done fill:#e8f5e9,stroke:#2e7d32,color:#2e7d32;
</code></pre>

<hr />

<h2 id="guardrails--good-manners">Guardrails &amp; good manners</h2>

<ul>
  <li><strong>Read-only before write-heavy</strong>: We don’t touch messages unless usage demands it.</li>
  <li><strong>Batching + back-off</strong>: Fixed-size deletes + a tiny pause keep API usage smooth and throttle-friendly.</li>
  <li><strong>Folder-scoped deletes only</strong>: Only <strong>Sent Items</strong> is pruned. Inbox and critical folders stay untouched.</li>
  <li><strong>Safe thresholds</strong>: The <code class="language-plaintext highlighter-rouge">50%/49%</code> band avoids thrash and keeps runs short.</li>
  <li><strong>Minimal permissions</strong>: Graph scopes are limited to what’s required for folder read + message delete.</li>
  <li><strong>Idempotent by design</strong>: If a run is interrupted, the next one simply re-evaluates usage and continues.</li>
</ul>

<h2 id="closing-thoughts">Closing thoughts</h2>

<p>This is one of those <em>“small but mighty”</em> automations: it quietly removes a class of operational noise. n8n made it simple to build a safe, auditable, and repeatable mailbox hygiene policy—without wiring up a bespoke service or doing cron yoga.</p>

<p>If you’re already using n8n for internal automations, this pattern <code class="language-plaintext highlighter-rouge">(measure → batch → verify → report)</code> is reusable well beyond email. And if you’re not… consider this your sign.</p>

  </div>
  <footer class="post__footer">
    
      <div class="post__tags">
        <strong>Tags:</strong>
        <span class="tag">#outlook</span><span class="tag">#n8n</span><span class="tag">#microsoft-graph</span><span class="tag">#automation</span><span class="tag">#email</span><span class="tag">#quota-management</span><span class="tag">#workflows</span>
      </div>
    
    <nav class="post__pager">
      <a class="pager__prev" href="/Zinus/posts/2025/09/03/n8n-shopify-anti-bot-cancellations/">← n8n on self-hosted servers to auto-cancel bot-generated warranty‑only Shopify orders</a>
      <a class="pager__next" href="/Zinus/posts/2025/09/10/embedded-app-architecture-checkout-extensions/">Zinus Embedded App: Remix + Shopify Functions powering checkout experiences →</a>
    </nav>
  </footer>
</article>



    </main>
    <footer class="site-footer">
  <div class="container footer__inner">
    <p>© 2025 Zinus, Inc. All rights reserved.</p>
    <ul class="social">
      
        <li><a href="https://github.com/zinus-inc" target="_blank" rel="noopener">GitHub</a></li>
      
      
        <li><a href="https://www.linkedin.com/company/zinus-inc/posts/?feedView=all" target="_blank" rel="noopener">LinkedIn</a></li>
      
      <li><a href="/Zinus/feed.xml">RSS</a></li>
    </ul>
  </div>
</footer>



  </body>
  </html>


